import{G as Se,f as ce,i as pe,j as F,c as v,g as H,u as p,y as N,o as r,m as R,a as _,n as $e,x as he,_ as le,t as I,e as f,F as Me,z as fe,H as Ie,k as se,h as re,s as ke,p as Ce,q as xe,d as ge,C as Ee,B as me}from"./index-DyncoFNp.js";import{I as K}from"./Icon-XsD-7neM.js";import{N as Ne}from"./NetworkAlert-BzZ3Rn47.js";import{E as Ae}from"./Empty-Dhm7Ynwu.js";import{A as we}from"./Avatar-BvJYmT9C.js";import{A as De}from"./Appellation-5sErKFFL.js";import{E as Ve,e as Oe}from"./emoji-Bh8i_--D.js";import{s as de}from"./toast-DSCwmRst.js";import{t as be}from"./reporter-Cs0pKN63.js";import"./index.esm-CPwIBr9T.js";import"./package-DKjbUiep.js";var ve={exports:{}},Ye=ve.exports,Te;function Pe(){return Te||(Te=1,function(W,M){(function(a,C){W.exports=C()})(Ye,function(){var a=1e3,C=6e4,k=36e5,m="millisecond",$="second",t="minute",V="hour",g="day",L="week",A="month",X="quarter",G="year",U="date",q="Invalid Date",ee=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ne=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ae={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var s=["th","st","nd","rd"],e=i%100;return"["+i+(s[(e-20)%10]||s[e]||s[0])+"]"}},J=function(i,s,e){var o=String(i);return!o||o.length>=s?i:""+Array(s+1-o.length).join(e)+i},y={s:J,z:function(i){var s=-i.utcOffset(),e=Math.abs(s),o=Math.floor(e/60),n=e%60;return(s<=0?"+":"-")+J(o,2,"0")+":"+J(n,2,"0")},m:function i(s,e){if(s.date()<e.date())return-i(e,s);var o=12*(e.year()-s.year())+(e.month()-s.month()),n=s.clone().add(o,A),c=e-n<0,l=s.clone().add(o+(c?-1:1),A);return+(-(o+(e-n)/(c?n-l:l-n))||0)},a:function(i){return i<0?Math.ceil(i)||0:Math.floor(i)},p:function(i){return{M:A,y:G,w:L,d:g,D:U,h:V,m:t,s:$,ms:m,Q:X}[i]||String(i||"").toLowerCase().replace(/s$/,"")},u:function(i){return i===void 0}},w="en",x={};x[w]=ae;var b="$isDayjsObject",h=function(i){return i instanceof Y||!(!i||!i[b])},T=function i(s,e,o){var n;if(!s)return w;if(typeof s=="string"){var c=s.toLowerCase();x[c]&&(n=c),e&&(x[c]=e,n=c);var l=s.split("-");if(!n&&l.length>1)return i(l[0])}else{var S=s.name;x[S]=s,n=S}return!o&&n&&(w=n),n||!o&&w},d=function(i,s){if(h(i))return i.clone();var e=typeof s=="object"?s:{};return e.date=i,e.args=arguments,new Y(e)},u=y;u.l=T,u.i=h,u.w=function(i,s){return d(i,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var Y=function(){function i(e){this.$L=T(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[b]=!0}var s=i.prototype;return s.parse=function(e){this.$d=function(o){var n=o.date,c=o.utc;if(n===null)return new Date(NaN);if(u.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var l=n.match(ee);if(l){var S=l[2]-1||0,E=(l[7]||"0").substring(0,3);return c?new Date(Date.UTC(l[1],S,l[3]||1,l[4]||0,l[5]||0,l[6]||0,E)):new Date(l[1],S,l[3]||1,l[4]||0,l[5]||0,l[6]||0,E)}}return new Date(n)}(e),this.init()},s.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},s.$utils=function(){return u},s.isValid=function(){return this.$d.toString()!==q},s.isSame=function(e,o){var n=d(e);return this.startOf(o)<=n&&n<=this.endOf(o)},s.isAfter=function(e,o){return d(e)<this.startOf(o)},s.isBefore=function(e,o){return this.endOf(o)<d(e)},s.$g=function(e,o,n){return u.u(e)?this[o]:this.set(n,e)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(e,o){var n=this,c=!!u.u(o)||o,l=u.p(e),S=function(Q,P){var B=u.w(n.$u?Date.UTC(n.$y,P,Q):new Date(n.$y,P,Q),n);return c?B:B.endOf(g)},E=function(Q,P){return u.w(n.toDate()[Q].apply(n.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(P)),n)},D=this.$W,O=this.$M,j=this.$D,te="set"+(this.$u?"UTC":"");switch(l){case G:return c?S(1,0):S(31,11);case A:return c?S(1,O):S(0,O+1);case L:var Z=this.$locale().weekStart||0,oe=(D<Z?D+7:D)-Z;return S(c?j-oe:j+(6-oe),O);case g:case U:return E(te+"Hours",0);case V:return E(te+"Minutes",1);case t:return E(te+"Seconds",2);case $:return E(te+"Milliseconds",3);default:return this.clone()}},s.endOf=function(e){return this.startOf(e,!1)},s.$set=function(e,o){var n,c=u.p(e),l="set"+(this.$u?"UTC":""),S=(n={},n[g]=l+"Date",n[U]=l+"Date",n[A]=l+"Month",n[G]=l+"FullYear",n[V]=l+"Hours",n[t]=l+"Minutes",n[$]=l+"Seconds",n[m]=l+"Milliseconds",n)[c],E=c===g?this.$D+(o-this.$W):o;if(c===A||c===G){var D=this.clone().set(U,1);D.$d[S](E),D.init(),this.$d=D.set(U,Math.min(this.$D,D.daysInMonth())).$d}else S&&this.$d[S](E);return this.init(),this},s.set=function(e,o){return this.clone().$set(e,o)},s.get=function(e){return this[u.p(e)]()},s.add=function(e,o){var n,c=this;e=Number(e);var l=u.p(o),S=function(O){var j=d(c);return u.w(j.date(j.date()+Math.round(O*e)),c)};if(l===A)return this.set(A,this.$M+e);if(l===G)return this.set(G,this.$y+e);if(l===g)return S(1);if(l===L)return S(7);var E=(n={},n[t]=C,n[V]=k,n[$]=a,n)[l]||1,D=this.$d.getTime()+e*E;return u.w(D,this)},s.subtract=function(e,o){return this.add(-1*e,o)},s.format=function(e){var o=this,n=this.$locale();if(!this.isValid())return n.invalidDate||q;var c=e||"YYYY-MM-DDTHH:mm:ssZ",l=u.z(this),S=this.$H,E=this.$m,D=this.$M,O=n.weekdays,j=n.months,te=n.meridiem,Z=function(P,B,ie,ue){return P&&(P[B]||P(o,c))||ie[B].slice(0,ue)},oe=function(P){return u.s(S%12||12,P,"0")},Q=te||function(P,B,ie){var ue=P<12?"AM":"PM";return ie?ue.toLowerCase():ue};return c.replace(ne,function(P,B){return B||function(ie){switch(ie){case"YY":return String(o.$y).slice(-2);case"YYYY":return u.s(o.$y,4,"0");case"M":return D+1;case"MM":return u.s(D+1,2,"0");case"MMM":return Z(n.monthsShort,D,j,3);case"MMMM":return Z(j,D);case"D":return o.$D;case"DD":return u.s(o.$D,2,"0");case"d":return String(o.$W);case"dd":return Z(n.weekdaysMin,o.$W,O,2);case"ddd":return Z(n.weekdaysShort,o.$W,O,3);case"dddd":return O[o.$W];case"H":return String(S);case"HH":return u.s(S,2,"0");case"h":return oe(1);case"hh":return oe(2);case"a":return Q(S,E,!0);case"A":return Q(S,E,!1);case"m":return String(E);case"mm":return u.s(E,2,"0");case"s":return String(o.$s);case"ss":return u.s(o.$s,2,"0");case"SSS":return u.s(o.$ms,3,"0");case"Z":return l}return null}(P)||l.replace(":","")})},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(e,o,n){var c,l=this,S=u.p(o),E=d(e),D=(E.utcOffset()-this.utcOffset())*C,O=this-E,j=function(){return u.m(l,E)};switch(S){case G:c=j()/12;break;case A:c=j();break;case X:c=j()/3;break;case L:c=(O-D)/6048e5;break;case g:c=(O-D)/864e5;break;case V:c=O/k;break;case t:c=O/C;break;case $:c=O/a;break;default:c=O}return n?c:u.a(c)},s.daysInMonth=function(){return this.endOf(A).$D},s.$locale=function(){return x[this.$L]},s.locale=function(e,o){if(!e)return this.$L;var n=this.clone(),c=T(e,o,!0);return c&&(n.$L=c),n},s.clone=function(){return u.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},i}(),z=Y.prototype;return d.prototype=z,[["$ms",m],["$s",$],["$m",t],["$H",V],["$W",g],["$M",A],["$y",G],["$D",U]].forEach(function(i){z[i[1]]=function(s){return this.$g(s,i[0],i[1])}}),d.extend=function(i,s){return i.$i||(i(s,Y,d),i.$i=!0),d},d.locale=T,d.isDayjs=h,d.unix=function(i){return d(1e3*i)},d.en=x[w],d.Ls=x,d.p={},d})}(ve)),ve.exports}var Le=Pe();const _e=Se(Le),Ge={key:0,class:"p2p-msg-receipt-wrapper"},Ue={key:0,class:"icon-read-wrapper"},je={key:1,class:"sector"},Fe=ce({__name:"conversation-item-read",props:{conversation:{}},setup(W){const{proxy:M}=pe(),a=W,C=M==null?void 0:M.$UIKitStore.localOptions.p2pMsgReceiptVisible,k=M==null?void 0:M.$NIM.V2NIMConversationIdUtil.parseConversationType(a.conversation.conversationId),m=F(()=>{var $,t,V,g;return((($=a==null?void 0:a.conversation)==null?void 0:$.msgReceiptTime)||0)>=(((g=(V=(t=a==null?void 0:a.conversation)==null?void 0:t.lastMessage)==null?void 0:V.messageRefer)==null?void 0:g.createTime)||0)?360:0});return($,t)=>p(k)===p(N).V2NIMConversationType.V2NIM_CONVERSATION_TYPE_P2P&&p(C)?(r(),v("div",Ge,[m.value==360?(r(),v("div",Ue,[R(K,{type:"icon-read",size:16})])):(r(),v("div",je,[_("span",{class:"cover-1",style:$e(`transform: rotate(${m.value}deg)`)},null,4),_("span",{class:he(m.value>=180?"cover-2 cover-3":"cover-2")},null,2)]))])):H("",!0)}}),He=le(Fe,[["__scopeId","data-v-b8adaa6e"]]),Re={key:0},We={key:1},ze={key:2},Be={key:3},Ke={key:4},Xe={key:5},qe={key:6},Je={key:7},Ze={key:8},Qe={key:9},et={key:10},tt={key:11},st={key:12,class:"msg-conversation-text-wrap"},nt={key:0,class:"msg-conversation-text"},at={key:1,class:"msg-conversation-text-emoji"},ot=ce({__name:"conversation-item-last-msg-content",props:{lastMessage:{}},setup(W){const M=W,a=m=>{if(!m)return[];const $=[];let t;const V=Oe;for(;(t=V.exec(m))!==null;){$.push({type:"emoji",value:t[0],index:t.index});const g=" ".repeat(t[0].length);m=m.replace(t[0],g)}return m=m.replace(V," "),m&&m.split(" ").filter(g=>g.trim()).map(g=>{const L=m==null?void 0:m.indexOf(g);$.push({type:"text",value:g,index:L});const A=" ".repeat(g.length);m=m.replace(g,A)}),$.sort((g,L)=>g.index-L.index)},C=F(()=>a(M.lastMessage.text)),k=m=>`[${{textMsgText:f("textMsgText"),customMsgText:f("customMsgText"),audioMsgText:f("audioMsgText"),videoMsgText:f("videoMsgText"),fileMsgText:f("fileMsgText"),callMsgText:f("callMsgText"),geoMsgText:f("geoMsgText"),imgMsgText:f("imgMsgText"),notiMsgText:f("notiMsgText"),robotMsgText:f("robotMsgText"),tipMsgText:f("tipMsgText"),unknowMsgText:f("unknowMsgText")}[m]||""}]`;return(m,$)=>(r(),v("div",null,[M.lastMessage.lastMessageState===p(N).V2NIMLastMessageState.V2NIM_MESSAGE_STATUS_REVOKE?(r(),v("div",Re,I(p(f)("recall")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_NOTIFICATION?(r(),v("div",We,I(p(f)("conversationNotificationText")),1)):M.lastMessage.sendingState===p(N).V2NIMMessageSendingState.V2NIM_MESSAGE_SENDING_STATE_FAILED?(r(),v("div",ze,I(p(f)("conversationSendFailText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_FILE?(r(),v("div",Be,I(k("fileMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_IMAGE?(r(),v("div",Ke,I(k("imgMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_CUSTOM?(r(),v("div",Xe,I(M.lastMessage.text||k("customMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_AUDIO?(r(),v("div",qe,I(k("audioMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_CALL?(r(),v("div",Je,I(k("callMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_LOCATION?(r(),v("div",Ze,I(k("geoMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_ROBOT?(r(),v("div",Qe,I(k("robotMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_TIPS?(r(),v("div",et,I(k("tipMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_VIDEO?(r(),v("div",tt,I(k("videoMsgText")),1)):M.lastMessage.messageType===p(N).V2NIMMessageType.V2NIM_MESSAGE_TYPE_TEXT?(r(),v("div",st,[(r(!0),v(Me,null,fe(C.value,t=>(r(),v(Me,null,[t.type==="text"?(r(),v("span",nt,I(t.value),1)):t.type==="emoji"?(r(),v("span",at,[R(K,{type:p(Ve)[t.value],size:16},null,8,["type"])])):H("",!0)],64))),256))])):H("",!0)]))}}),it=le(ot,[["__scopeId","data-v-8feb23a0"]]),rt={class:"conversation-item-content"},ct={class:"conversation-item-left"},lt={key:0,class:"unread"},ut={key:0,class:"dot"},dt={key:1,class:"badge"},vt={class:"conversation-item-right"},ht={class:"conversation-item-top"},Mt={key:1,class:"conversation-item-title"},_t={class:"conversation-item-time"},pt={class:"conversation-item-desc"},ft={class:"conversation-item-desc-span"},gt={key:0,class:"beMentioned"},mt={key:2,class:"conversation-item-desc-content"},Tt={class:"conversation-item-state"},yt={class:"right-action-list"},St=["onClick"],ye=99,$t=ce({__name:"conversation-item",props:{conversation:{},showMoreActions:{type:Boolean,default:!1}},emits:["click","delete","stickyToTop","leftSlide"],setup(W,{emit:M}){const a=W,{proxy:C}=pe(),k=M,m=F(()=>[{name:a.conversation.stickTop?f("deleteStickTopText"):f("addStickTopText"),class:"action-top",type:"action-top"},{name:f("deleteSessionText"),class:"action-delete",type:"action-delete"}]),$=y=>{k(y==="action-top"?"stickyToTop":"delete",a.conversation)},t=F(()=>{if(a.conversation.type===N.V2NIMConversationType.V2NIM_CONVERSATION_TYPE_TEAM){const{avatar:y}=a.conversation;return y}}),V=F(()=>a.conversation.name?a.conversation.name:a.conversation.conversationId),g=F(()=>C==null?void 0:C.$NIM.V2NIMConversationIdUtil.parseConversationTargetId(a.conversation.conversationId)),L=F(()=>{var h;const y=((h=a.conversation.lastMessage)==null?void 0:h.messageRefer.createTime)||a.conversation.updateTime;if(!y)return"";const w=_e(y),x=w.isSame(_e(),"day"),b=w.isSame(_e(),"year");return w.format(x?"HH:mm":b?"MM-DD HH:mm":"YYYY-MM-DD HH:mm")}),A=F(()=>a.conversation.unreadCount>0?a.conversation.unreadCount>ye?`${ye}+`:a.conversation.unreadCount+"":""),X=F(()=>!!a.conversation.mute),G=F(()=>{var y;return!!((y=a.conversation.aitMsgs)!=null&&y.length)}),U=F(()=>{var w,x,b,h,T,d,u,Y,z,i;const y=C==null?void 0:C.$NIM.V2NIMLoginService.getLoginUser();return a.conversation.type===N.V2NIMConversationType.V2NIM_CONVERSATION_TYPE_P2P?((x=(w=a==null?void 0:a.conversation)==null?void 0:w.lastMessage)==null?void 0:x.messageRefer.senderId)===y&&((h=(b=a==null?void 0:a.conversation)==null?void 0:b.lastMessage)==null?void 0:h.messageType)!==N.V2NIMMessageType.V2NIM_MESSAGE_TYPE_CALL&&((d=(T=a==null?void 0:a.conversation)==null?void 0:T.lastMessage)==null?void 0:d.messageType)!==N.V2NIMMessageType.V2NIM_MESSAGE_TYPE_NOTIFICATION&&((Y=(u=a==null?void 0:a.conversation)==null?void 0:u.lastMessage)==null?void 0:Y.sendingState)===N.V2NIMMessageSendingState.V2NIM_MESSAGE_SENDING_STATE_SUCCEEDED&&((i=(z=a==null?void 0:a.conversation)==null?void 0:z.lastMessage)==null?void 0:i.lastMessageState)!==N.V2NIMLastMessageState.V2NIM_MESSAGE_STATUS_REVOKE:!1});let q=0,ee=0;function ne(y){q=y.changedTouches[0].pageX,ee=y.changedTouches[0].pageY}function ae(y){const w=y.changedTouches[0].pageX,x=y.changedTouches[0].pageY,b=w-q+20,h=x-ee;Math.abs(b)>Math.abs(h)&&b>0?k("leftSlide",null):Math.abs(b)>Math.abs(h)&&b<0&&k("leftSlide",a.conversation)}function J(){if(a.showMoreActions){k("leftSlide",null);return}k("click",a.conversation)}return Ie(()=>{console.log("onUpdated",a.conversation.unreadCount)}),(y,w)=>(r(),v("div",{class:he(["conversation-item-container",{"show-action-list":y.showMoreActions,"stick-on-top":y.conversation.stickTop}]),onTouchstart:ne,onTouchmove:ae,onClick:w[0]||(w[0]=()=>J())},[_("div",rt,[_("div",ct,[A.value?(r(),v("div",lt,[X.value?(r(),v("div",ut)):(r(),v("div",dt,I(A.value),1))])):H("",!0),R(we,{account:g.value,avatar:t.value},null,8,["account","avatar"])]),_("div",vt,[_("div",ht,[y.conversation.type===p(N).V2NIMConversationType.V2NIM_CONVERSATION_TYPE_P2P?(r(),se(De,{key:0,class:"conversation-item-title",account:g.value},null,8,["account"])):(r(),v("span",Mt,I(V.value),1)),_("span",_t,I(L.value),1)]),_("div",pt,[_("span",ft,[G.value?(r(),v("span",gt,I("["+p(f)("someoneText")+"@"+p(f)("meText")+"]"),1)):H("",!0),U.value?(r(),se(He,{key:1,conversation:a.conversation},null,8,["conversation"])):H("",!0),a.conversation.lastMessage?(r(),v("span",mt,[R(it,{lastMessage:a.conversation.lastMessage},null,8,["lastMessage"])])):H("",!0)]),_("div",Tt,[X.value?(r(),se(K,{key:0,iconClassName:"conversation-item-desc-state",type:"icon-xiaoximiandarao",color:"#ccc"})):H("",!0)])])])]),_("div",yt,[(r(!0),v(Me,null,fe(m.value,x=>(r(),v("div",{key:x.type,class:he(["right-action-item",x.class]),onClick:()=>$(x.type)},I(x.name),11,St))),128))])],34))}}),It=le($t,[["__scopeId","data-v-a2fb74ad"]]),kt={class:"conversation-wrapper"},Ct={class:"navigation-bar"},xt={class:"logo-box"},Et={key:0,class:"dropdown-container"},Nt={class:"add-menu-list"},At={key:1},wt={class:"security-tip"},Dt={class:"search-input-wrapper"},Vt={class:"search-icon-wrapper"},Ot={class:"search-input"},bt={class:"security-tip"},Yt={class:"search-input-wrapper"},Pt={class:"search-icon-wrapper"},Lt={class:"search-input"},Gt=ce({__name:"conversation-list",setup(W){var b;const M=re([]),a=re(!1),C=re("");let k="button-box";const m=Ee(),{proxy:$}=pe(),t=$==null?void 0:$.$UIKitStore,V=$==null?void 0:$.$NIM;be("ContactUIKit",V.options.appkey);const g=(b=t==null?void 0:t.sdkOptions)==null?void 0:b.enableV2CloudConversation,L=re(null),A=re(!1);ke(()=>{t==null||t.uiStore.selectConversation("")});const X=async h=>{var u,Y,z,i;const T=h.target;if(!T)return;if(T.scrollHeight-T.scrollTop<=T.clientHeight+1&&!A.value){A.value=!0;const s=(t==null?void 0:t.localOptions.conversationLimit)||100;try{if(g){const e=(u=t.uiStore.conversations[t.uiStore.conversations.length-1])==null?void 0:u.sortOrder;await((Y=t==null?void 0:t.conversationStore)==null?void 0:Y.getConversationListActive(e,s))}else{const e=(z=t==null?void 0:t.uiStore.localConversations[t.uiStore.localConversations.length-1])==null?void 0:z.sortOrder;await((i=t==null?void 0:t.localConversationStore)==null?void 0:i.getConversationListActive(e,s))}}catch(e){console.error("加载更多会话失败:",e)}finally{A.value=!1}}},G=h=>{h?C.value=h.conversationId:C.value=""};let U=!1;const q=async h=>{if(!U){C.value="";try{U=!0,await(t==null?void 0:t.uiStore.selectConversation(h.conversationId)),m.push(me.chat)}catch{de({message:f("selectSessionFailText"),type:"info"})}finally{U=!1}}},ee=async h=>{var T,d;try{g?await((T=t==null?void 0:t.conversationStore)==null?void 0:T.deleteConversationActive(h.conversationId)):await((d=t==null?void 0:t.localConversationStore)==null?void 0:d.deleteConversationActive(h.conversationId)),C.value=""}catch{de({message:f("deleteSessionFailText"),type:"info"})}},ne=async h=>{var T,d,u,Y;if(h.stickTop)try{g?await((T=t==null?void 0:t.conversationStore)==null?void 0:T.stickTopConversationActive(h.conversationId,!1)):await((d=t==null?void 0:t.localConversationStore)==null?void 0:d.stickTopConversationActive(h.conversationId,!1))}catch{de({message:f("deleteStickTopFailText"),type:"info"})}else try{g?await((u=t==null?void 0:t.conversationStore)==null?void 0:u.stickTopConversationActive(h.conversationId,!0)):await((Y=t==null?void 0:t.localConversationStore)==null?void 0:Y.stickTopConversationActive(h.conversationId,!0))}catch{de({message:f("addStickTopFailText"),type:"info"})}},ae=()=>{a.value=!0},J=()=>{a.value=!1},y=h=>{a.value=!1,m.push({name:h==="addFriend"?"AddFriend":"TeamCreate"})},w=()=>{m.push(me.conversationSearch)},x=Ce(()=>{var T,d;const h=g?(T=t==null?void 0:t.uiStore)==null?void 0:T.conversations:(d=t==null?void 0:t.uiStore)==null?void 0:d.localConversations;M.value=h==null?void 0:h.sort((u,Y)=>Y.sortOrder-u.sortOrder)});return xe(()=>{a.value=!1,x()}),(h,T)=>(r(),v("div",kt,[a.value?(r(),v("div",{key:0,class:"dropdown-mark",onTouchstart:J},null,32)):H("",!0),_("div",Ct,[_("div",xt,[T[2]||(T[2]=_("img",{src:"https://yx-web-nosdn.netease.im/common/bbcd9929e31bfee02663fc0bcdabe1c5/yx-logo.png",class:"logo-img"},null,-1)),_("div",null,I(p(f)("appText")),1)]),_("div",{class:he(p(k))},[_("div",{class:"button-icon-add",onClick:ae},[R(K,{type:"icon-More",size:24})]),a.value?(r(),v("div",Et,[_("div",Nt,[_("div",{class:"add-menu-item",onClick:T[0]||(T[0]=d=>y("addFriend"))},[R(K,{type:"icon-tianjiahaoyou",style:{marginRight:"5px"}}),ge(" "+I(p(f)("addFriendText")),1)]),_("div",{class:"add-menu-item",onClick:T[1]||(T[1]=d=>y("createGroup"))},[R(K,{type:"icon-chuangjianqunzu",style:{marginRight:"5px"}}),ge(" "+I(p(f)("createTeamText")),1)])])])):H("",!0)],2)]),T[3]||(T[3]=_("div",{class:"block"},null,-1)),R(Ne),!M.value||M.value.length===0?(r(),v("div",At,[_("div",wt,[_("div",null,I(p(f)("securityTipText")),1)]),_("div",{class:"conversation-search",onClick:w},[_("div",Dt,[_("div",Vt,[R(K,{iconClassName:"search-icon",size:16,color:"#A6ADB6",type:"icon-sousuo"})]),_("div",Ot,I(p(f)("searchText")),1)])]),!M.value||M.value.length===0?(r(),se(Ae,{key:0,text:p(f)("conversationEmptyText")},null,8,["text"])):H("",!0)])):(r(),v("div",{key:2,class:"conversation-list-wrapper",ref_key:"listWrapper",ref:L,onScroll:X},[_("div",bt,[_("div",null,I(p(f)("securityTipText")),1)]),_("div",{class:"conversation-search",onClick:w},[_("div",Yt,[_("div",Pt,[R(K,{iconClassName:"search-icon",size:16,color:"#A6ADB6",type:"icon-sousuo"})]),_("div",Lt,I(p(f)("searchText")),1)])]),(r(!0),v(Me,null,fe(M.value,d=>(r(),v("div",{key:d.conversationId},[(r(),se(It,{key:d.conversationId,showMoreActions:C.value===d.conversationId,conversation:d,onDelete:ee,onStickyToTop:ne,onClick:q,onLeftSlide:G},null,8,["showMoreActions","conversation"]))]))),128))],544))]))}}),Ut=le(Gt,[["__scopeId","data-v-608d851f"]]),jt=ce({__name:"ConversationPage",setup(W){return(M,a)=>(r(),se(Ut))}}),Qt=le(jt,[["__scopeId","data-v-8509becc"]]);export{Qt as default};

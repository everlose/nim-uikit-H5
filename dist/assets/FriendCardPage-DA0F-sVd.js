import{U as R}from"./UserCard-BOjpmzBo.js";import{f as B,i as E,h as r,s as V,C as $,p as x,q as L,c as f,m as u,u as n,e as s,F as C,a as e,t as o,B as T,y as W,o as h,_ as q,k as D}from"./index-DyncoFNp.js";import{N as K}from"./NavBar-BSxUZM35.js";import{S as y}from"./Switch-BugMB2Zb.js";import{t as p,s as S}from"./toast-DSCwmRst.js";import{m as Y}from"./modal-DQBuBeBM.js";import{I as j}from"./Icon-XsD-7neM.js";import"./Avatar-BvJYmT9C.js";const O={class:"wrapper"},z={class:"userInfo-item-wrapper"},G={class:"userInfo-item"},H={class:"item-left"},J={class:"userInfo-item-wrapper"},Q={class:"item-left"},X={class:"item-right"},Z={class:"item-right-alias"},ee={class:"item-right"},te={class:"userInfo-item"},se={class:"item-left"},ie={class:"item-right"},ae={class:"userInfo-item"},ne={class:"item-left"},oe={class:"item-right"},le={class:"userInfo-item"},ce={class:"item-left"},de={class:"item-right"},re={class:"userInfo-item"},ue={class:"item-left"},me={class:"item-right"},ve={class:"userInfo-item"},_e={class:"item-left"},he={class:"item-right"},fe={class:"userInfo-item-wrapper"},pe={class:"userInfo-item"},ge={class:"item-left"},Ie=B({__name:"index",setup(b){const m=$(),{proxy:d}=E(),t=d==null?void 0:d.$UIKitStore,A=d==null?void 0:d.$NIM,g=r();r();const a=r(),I=r("stranger"),v=r(!1);let l="";const N=c=>{c.stopPropagation(),m.push({path:T.friendInfoEdit,query:{accountId:l}})};V(()=>{l=m.currentRoute.value.query.accountId||"",t==null||t.userStore.getUserForceActive(l).then(i=>{a.value=i,console.log("userInfo==================",i)}),k=x(()=>{a.value=t==null?void 0:t.uiStore.getFriendWithUserNameCard(l)}),F=x(()=>{const{relation:i,isInBlacklist:_}=t==null?void 0:t.uiStore.getRelation(l);I.value=i,v.value=_});const c=t==null?void 0:t.friendStore.friends.get(l);g.value=c?c.alias:""});let k=()=>{},F=()=>{};const w=async c=>{const i=c;v.value=c;try{i?await(t==null?void 0:t.relationStore.addUserToBlockListActive(l)):await(t==null?void 0:t.relationStore.removeUserFromBlockListActive(l))}catch{p.info(i?s("setBlackFailText"):s("removeBlackFailText"))}},U=()=>{Y.confirm({title:s("deleteFriendText"),content:`${s("deleteFriendConfirmText")}"${t==null?void 0:t.uiStore.getAppellation({account:l})}"?`,async onConfirm(){try{await(t==null?void 0:t.friendStore.deleteFriendActive(l)),p.info(s("deleteFriendSuccessText"))}catch{p.info(s("deleteFriendFailText"))}}})},M=async()=>{try{await(t==null?void 0:t.friendStore.addFriendActive(l,{addMode:W.V2NIMFriendAddMode.V2NIM_FRIEND_MODE_TYPE_APPLY,postscript:""})),await(t==null?void 0:t.relationStore.removeUserFromBlockListActive(l)),S({message:s("applyFriendSuccessText"),type:"info"})}catch{S({message:s("applyFriendFailText"),type:"info"})}},P=async()=>{var i;const c=A.V2NIMConversationIdUtil.p2pConversationId(((i=a.value)==null?void 0:i.accountId)||"");await(t==null?void 0:t.uiStore.selectConversation(c)),m.push(T.chat)};return L(()=>{k(),F()}),(c,i)=>(h(),f("div",O,[u(K,{title:n(s)("FriendPageText")},null,8,["title"]),u(R,{account:a.value&&a.value.accountId,nick:a.value&&a.value.name},null,8,["account","nick"]),I.value==="stranger"?(h(),f(C,{key:0},[e("div",z,[e("div",G,[e("div",H,o(n(s)("addBlacklist")),1),u(y,{checked:v.value,onChange:i[0]||(i[0]=_=>w(_))},null,8,["checked"])])]),e("div",{class:"button",style:{marginTop:"10px"},onClick:M},o(n(s)("addFriendText")),1)],64)):(h(),f(C,{key:1},[e("div",J,[e("div",{class:"userInfo-item",onClick:N},[e("div",Q,o(n(s)("remarkText")),1),e("div",X,[e("span",Z,o(g.value),1),e("span",ee,[u(j,{iconClassName:"more-icon",color:"#999",type:"icon-jiantou"})])])]),e("div",te,[e("div",se,o(n(s)("genderText")),1),e("div",ie,o(a.value&&a.value.gender===0?n(s)("unknow"):a.value&&a.value.gender===1?n(s)("man"):n(s)("woman")),1)]),i[1]||(i[1]=e("div",{class:"box-shadow"},null,-1)),e("div",ae,[e("div",ne,o(n(s)("birthText")),1),e("div",oe,o(a.value&&a.value.birthday||n(s)("unknow")),1)]),i[2]||(i[2]=e("div",{class:"box-shadow"},null,-1)),e("div",le,[e("div",ce,o(n(s)("mobile")),1),e("div",de,o(a.value&&a.value.mobile||n(s)("unknow")),1)]),i[3]||(i[3]=e("div",{class:"box-shadow"},null,-1)),e("div",re,[e("div",ue,o(n(s)("email")),1),e("div",me,o(a.value&&a.value.email||n(s)("unknow")),1)]),e("div",ve,[e("div",_e,o(n(s)("sign")),1),e("div",he,o(a.value&&a.value.sign||n(s)("unknow")),1)])]),e("div",fe,[e("div",pe,[e("div",ge,o(n(s)("addBlacklist")),1),u(y,{checked:v.value,onChange:w},null,8,["checked"])])]),e("div",{class:"button",onClick:P},o(n(s)("chatWithFriendText")),1),i[4]||(i[4]=e("div",{class:"box-shadow"},null,-1)),e("div",{class:"button button-red",onClick:U},o(n(s)("deleteFriendText")),1)],64))]))}}),ke=q(Ie,[["__scopeId","data-v-f8863aa1"]]),be=B({__name:"FriendCardPage",setup(b){return(m,d)=>(h(),D(ke))}});export{be as default};

import{A as w}from"./Avatar-BvJYmT9C.js";import{N as C}from"./NavBar-BSxUZM35.js";import{f as h,i as U,h as A,j as T,y as r,s as j,C as G,p as W,q,c,m as d,g as v,k as y,u,e as o,a as V,t as E,F as z,z as F,B as P,o as m,_ as D}from"./index-DyncoFNp.js";import{A as K}from"./Appellation-5sErKFFL.js";import{I as $}from"./Icon-XsD-7neM.js";import{E as H}from"./Empty-Dhm7Ynwu.js";import{s as J}from"./modal-DQBuBeBM.js";import{s as f}from"./toast-DSCwmRst.js";const Q={class:"team-member-container"},X={class:"add-item-label"},Y={key:1},Z={class:"team-member"},ee={key:0,class:"user-tag"},te={key:1,class:"user-tag"},ae=["onClick"],oe=h({__name:"index",setup(B){const R=G(),{proxy:M}=U(),e=M==null?void 0:M.$UIKitStore,i=A([]),_=A();let l="";const g=()=>{R.push({path:P.teamAdd,query:{teamId:l}})},k=t=>{J({title:o("confirmRemoveText"),content:o("removeMemberExplain"),confirmText:o("removeText"),onConfirm:()=>{e==null||e.teamMemberStore.removeTeamMemberActive({teamId:l,accounts:[t]}).then(()=>{f({message:o("removeSuccessText"),type:"info"})}).catch(a=>{switch(a==null?void 0:a.code){case 109306:f({message:o("noPermission"),type:"info"});break;default:f({message:o("removeFailText"),type:"info"});break}})}})},b=T(()=>{const t=e==null?void 0:e.userStore.myUserInfo;return(_.value?_.value.ownerAccountId:"")===(t?t.accountId:"")}),N=T(()=>{const t=e==null?void 0:e.userStore.myUserInfo;return i.value.filter(a=>a.memberRole===r.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER).some(a=>a.accountId===(t?t.accountId:""))}),O=T(()=>{var t;return((t=_.value)==null?void 0:t.inviteMode)===r.V2NIMTeamInviteMode.V2NIM_TEAM_INVITE_MODE_ALL?!0:b.value||N.value}),x=t=>t.accountId===(e==null?void 0:e.userStore.myUserInfo.accountId)?!1:b.value?!0:N.value?t.memberRole!==r.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER&&t.memberRole!==r.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER:!1;let p=()=>{};return j(()=>{l=R.currentRoute.value.query.teamId||"",p=W(()=>{_.value=e==null?void 0:e.teamStore.teams.get(l);const t=a=>{const n=a.filter(s=>s.memberRole===r.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER),L=a.filter(s=>s.memberRole===r.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER).sort((s,I)=>s.joinTime-I.joinTime),S=a.filter(s=>![r.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER,r.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER].includes(s.memberRole)).sort((s,I)=>s.joinTime-I.joinTime);return[...n,...L,...S]};i.value=t(e==null?void 0:e.teamMemberStore.getTeamMember(l))})}),q(()=>{p()}),(t,a)=>(m(),c("div",Q,[d(C,{title:u(o)("teamMemberText")},null,8,["title"]),O.value?(m(),c("div",{key:0,class:"add-item",onClick:g},[V("span",X,E(u(o)("addMemberText")),1),d($,{color:"#999",type:"icon-jiantou"})])):v("",!0),i.value.length?(m(),c("div",Y,[(m(!0),c(z,null,F(i.value,n=>(m(),c("div",{class:"team-item",key:n.accountId},[V("div",Z,[d(w,{"goto-user-card":!0,account:n.accountId,"team-id":n.teamId,size:"40"},null,8,["account","team-id"]),d(K,{class:"user-name",account:n.accountId,"team-id":n.teamId,"font-size":14},null,8,["account","team-id"]),n.memberRole===u(r).V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER?(m(),c("div",ee,E(u(o)("teamOwner")),1)):n.memberRole===u(r).V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER?(m(),c("div",te,E(u(o)("manager")),1)):v("",!0)]),x(n)?(m(),c("div",{key:0,class:"btn-remove",onClick:()=>{k(n.accountId)}},E(u(o)("removeText")),9,ae)):v("",!0)]))),128))])):(m(),y(H,{key:2,text:u(o)("noTeamMember")},null,8,["text"]))]))}}),ne=D(oe,[["__scopeId","data-v-d2139174"]]),_e=h({__name:"TeamMemberPage",setup(B){return(R,M)=>(m(),y(ne))}});export{_e as default};

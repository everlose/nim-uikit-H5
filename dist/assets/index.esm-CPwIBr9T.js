import{L as A,M as K}from"./index-DyncoFNp.js";var x=function(r,t){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])},x(r,t)};function E(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");x(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var b=function(){return b=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},b.apply(this,arguments)};function _(r,t,e,n){function o(i){return i instanceof e?i:new e(function(c){c(i)})}return new(e||(e=Promise))(function(i,c){function p(h){try{s(n.next(h))}catch(m){c(m)}}function d(h){try{s(n.throw(h))}catch(m){c(m)}}function s(h){h.done?i(h.value):o(h.value).then(p,d)}s((n=n.apply(r,[])).next())})}function k(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,c;return c={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function p(s){return function(h){return d([s,h])}}function d(s){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,s[0]&&(e=0)),e;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,o=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){e.label=s[1];break}if(s[0]===6&&e.label<i[1]){e.label=i[1],i=s;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(s);break}i[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(r,e)}catch(h){s=[6,h],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function j(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var q=function(r){var t=r.method,e=t===void 0?"POST":t,n=r.url,o=r.data,i=r.headers;return _(void 0,void 0,void 0,function(){var c,p;return k(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,K({method:e,url:n,data:o,headers:i})];case 1:return c=d.sent(),c.data.code!==200?[2,Promise.reject(c.data)]:[2,c.data];case 2:return p=d.sent(),[2,Promise.reject(p)];case 3:return[2]}})})},$=q,U=$,N="https://statistic.live.126.net/statics/report/xkit/action",B=function(){function r(t){var e=t.appKey,n=t.version,o=t.component,i=t.nertcVersion,c=t.imVersion,p=t.platform,d=p===void 0?"Web":p,s=t.channel,h=s===void 0?"netease":s;this.platform=d,this.appKey=e,this.version=n,this.component=o,this.nertcVersion=i,this.imVersion=c,this.channel=h}return r.prototype.track=function(t,e){return _(this,void 0,void 0,function(){var n,o,i,c,p,d,s,h,m;return k(this,function(y){switch(y.label){case 0:n=this,o=n.appKey,i=n.version,c=n.component,p=n.nertcVersion,d=n.imVersion,s=n.platform,h=n.channel,m=Date.now(),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,U({method:"POST",url:N,data:{appKey:o,version:i,component:c,timeStamp:m,nertcVersion:p,imVersion:d,platform:s,reportType:t,data:e,channel:h}})];case 2:return y.sent(),[3,4];case 3:return y.sent(),[3,4];case 4:return[2]}})})},r}(),z=B;(function(r){E(t,r);function t(e){var n=r.call(this)||this;return n.visibilityState=document.visibilityState,n.entries=[],n._visibilitychange=function(){n.visibilityState=document.visibilityState,n._trigger()},n.intersectionObserver=new IntersectionObserver(n._intersectionObserverHandler.bind(n),e),document.addEventListener("visibilitychange",n._visibilitychange),n}return t.prototype.observe=function(e){return this.intersectionObserver.observe(e)},t.prototype.unobserve=function(e){return this.intersectionObserver.unobserve(e)},t.prototype.destroy=function(){this.intersectionObserver.disconnect(),document.removeEventListener("visibilitychange",this._visibilitychange),this.entries=[]},t.prototype._intersectionObserverHandler=function(e,n){this.entries=e,this._trigger()},t.prototype._trigger=function(){var e=this;this.entries.forEach(function(n){if(e.visibilityState!=="visible"||n.intersectionRatio<=0){e.emit("visibleChange",{visible:!1,target:n.target});return}e.emit("visibleChange",{visible:!0,target:n.target})})},t})(A);var D=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H(r,t){return t={exports:{}},r(t,t.exports),t.exports}H(function(r){(function(t,e){r.exports?r.exports=e():t.log=e()})(D,function(){var t=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"];function i(l,f){var v=l[f];if(typeof v.bind=="function")return v.bind(l);try{return Function.prototype.bind.call(v,l)}catch{return function(){return Function.prototype.apply.apply(v,[l,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function p(l){return l==="debug"&&(l="log"),typeof console===e?!1:l==="trace"&&n?c:console[l]!==void 0?i(console,l):console.log!==void 0?i(console,"log"):t}function d(l,f){for(var v=0;v<o.length;v++){var u=o[v];this[u]=v<l?t:this.methodFactory(u,l,f)}this.log=this.debug}function s(l,f,v){return function(){typeof console!==e&&(d.call(this,f,v),this[l].apply(this,arguments))}}function h(l,f,v){return p(l)||s.apply(this,arguments)}function m(l,f,v){var u=this,O;f=f??"WARN";var g="loglevel";typeof l=="string"?g+=":"+l:typeof l=="symbol"&&(g=void 0);function W(a){var w=(o[a]||"silent").toUpperCase();if(!(typeof window===e||!g)){try{window.localStorage[g]=w;return}catch{}try{window.document.cookie=encodeURIComponent(g)+"="+w+";"}catch{}}}function I(){var a;if(!(typeof window===e||!g)){try{a=window.localStorage[g]}catch{}if(typeof a===e)try{var w=window.document.cookie,S=w.indexOf(encodeURIComponent(g)+"=");S!==-1&&(a=/^([^;]+)/.exec(w.slice(S))[1])}catch{}return u.levels[a]===void 0&&(a=void 0),a}}function F(){if(!(typeof window===e||!g)){try{window.localStorage.removeItem(g);return}catch{}try{window.document.cookie=encodeURIComponent(g)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}u.name=l,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=v||h,u.getLevel=function(){return O},u.setLevel=function(a,w){if(typeof a=="string"&&u.levels[a.toUpperCase()]!==void 0&&(a=u.levels[a.toUpperCase()]),typeof a=="number"&&a>=0&&a<=u.levels.SILENT){if(O=a,w!==!1&&W(a),d.call(u,a,l),typeof console===e&&a<u.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+a},u.setDefaultLevel=function(a){f=a,I()||u.setLevel(a,!1)},u.resetLevel=function(){u.setLevel(f,!1),F()},u.enableAll=function(a){u.setLevel(u.levels.TRACE,a)},u.disableAll=function(a){u.setLevel(u.levels.SILENT,a)};var L=I();L==null&&(L=f),u.setLevel(L,!1)}var y=new m,T={};y.getLogger=function(f){if(typeof f!="symbol"&&typeof f!="string"||f==="")throw new TypeError("You must supply a name when creating a logger.");var v=T[f];return v||(v=T[f]=new m(f,y.getLevel(),y.methodFactory)),v};var R=typeof window!==e?window.log:void 0;return y.noConflict=function(){return typeof window!==e&&window.log===y&&(window.log=R),y},y.getLoggers=function(){return T},y.default=y,y})});var C;(function(r){r[r.LOW=0]="LOW",r[r.NORMAL=1]="NORMAL",r[r.HIGH=2]="HIGH"})(C||(C={}));var G=function(){function r(t){this.appKey="",this.component="",this.data={},this.framework="",this.version="",this.startTime=0,this.endTime=0,this.duration=0,this.data.startTime=new Date().getTime(),this.data.timeStamp=this.data.startTime,this.eventId=t.eventId,this.priority=t.priority}return r.prototype.end=function(){this.data.endTime&&this.data.duration||(this.data.endTime=this.data.endTime||new Date().getTime(),this.data.duration=this.data.duration||this.data.endTime-this.data.startTime)},r.prototype.setAppInfo=function(t){this.appKey=t.appKey,this.component=t.component,this.version=t.version,t.framework&&(this.framework=t.framework)},r.prototype.endWith=function(t){var e=t.code,n=t.msg,o=t.requestId,i=t.serverCost;typeof e!="number"?this.data.code=-2:this.data.code=e,this.data.message=n,this.data.requestId=o,this.data.serverCost=i,this.end()},r.prototype.endWithSuccess=function(t){if(t){var e=t.requestId,n=t.serverCost;this.data.requestId=e,this.data.serverCost=n}this.data.code=0,this.data.message="success",this.end()},r.prototype.endWithFailure=function(t){if(t){var e=t.requestId,n=t.serverCost;this.data.requestId=e,this.data.serverCost=n}this.data.code=-1,this.data.message="failure",this.end()},r.prototype.setParams=function(t){return this.data.params=b({},t),this},r.prototype.addParams=function(t){return this.data.params=b(b({},this.data.params),t),this},r.prototype.setData=function(t){this.data=b(b({},this.data),t)},r.prototype.setUserId=function(t){this.data.userId=t},r}(),M=function(r){E(t,r);function t(e){return r.call(this,e)||this}return t}(G);(function(r){E(t,r);function t(e){var n=r.call(this,e)||this;return n._stepMap=new Map,n}return t.prototype.beginStep=function(e){if(this._stepMap.has(e))return this._stepMap[e];var n=new M({eventId:e,priority:this.priority});return n.setData({step:e}),this._stepMap.set(e,n),n},t.prototype.addStep=function(e){this._stepMap.set(e.eventId,e)},t.prototype.removeStep=function(e){this._stepMap.delete(e)},t.prototype.endWith=function(e){r.prototype.endWith.call(this,e),this.end()},t.prototype.endWithSuccess=function(e){r.prototype.endWithSuccess.call(this,e),this.end()},t.prototype.endWithFailure=function(e){r.prototype.endWithFailure.call(this,e),this.end()},t.prototype.end=function(){var e,n,o=[];r.prototype.end.call(this);try{for(var i=j(this._stepMap.values()),c=i.next();!c.done;c=i.next()){var p=c.value;p.data.index=o.length,o.push(p.data)}}catch(d){e={error:d}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}o.length>0&&(this.data.steps=o)},t})(M);function J(r){var t={img:/(png|gif|jpg)/i,pdf:/pdf$/i,word:/(doc|docx)$/i,excel:/(xls|xlsx)$/i,ppt:/(ppt|pptx)$/i,zip:/(zip|rar|7z)$/i,audio:/(mp3|wav|wmv)$/i,video:/(mp4|mkv|rmvb|wmv|avi|flv|mov)$/i};return Object.keys(t).find(function(e){return t[e].test(r)})||""}var Y=function(r,t){t===void 0&&(t=0);var e={0:"B",1:"KB",2:"MB",3:"GB",4:"TB"},n=function(o,i){return i>=Object.keys(e).length?"the file is too big":o<1024?"".concat(o).concat(e[i]):n(Math.round(o/1024),i+1)};return n(r,t)};function Q(r,t){var e=null;return function(){for(var n=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];e&&(clearTimeout(e),e=null),e=setTimeout(function(){r.apply(n,o)},t)}}export{z as E,Q as d,J as g,Y as p};
